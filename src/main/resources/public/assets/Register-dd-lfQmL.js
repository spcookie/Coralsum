import{u as A}from"./vue-l5MwoWad.js";import{I as k}from"./iconify-Dow0D7fd.js";import{a as B,f as L,h as S}from"./main-kPxSAhoX.js";import{u as U,k as V,l as d,c as p,B as c,y as Z}from"./naive-ui-DI5taouS.js";import{f as $,t as I,P as j,d as r,L as s,M as E,N as v,p as x}from"./@vue/runtime-core-HkD_qmHb.js";import{u as f,o as F,D as o}from"./@vue/reactivity-u6ABGPMg.js";import"./@vue/runtime-dom-hKZGlRKN.js";import"./@vue/shared-B44ZMsZr.js";import"./axios-B9ygI19o.js";import"./index-Sc79Mvov.js";/* empty css                               *//* empty css                                   */import"./@iconify-icons/mdi-DHJ9wI3J.js";import"./@iconify-icons/material-symbols-ysi_2Ggx.js";import"./@iconify-icons/ph-Cp5BnHKQ.js";import"./@iconify-icons/solar-D92Mec1c.js";import"./date-fns-Ddv6U-Yp.js";import"./vooks-CHP5O5D0.js";import"./evtd-CI_DDEu_.js";import"./seemly-D48R1BPg.js";import"./lodash-es-Bym2J9Gs.js";import"./@emotion/hash-WldOFDRm.js";import"./vueuc-CfobdMGE.js";import"./@css-render/vue3-ssr-Dz-R1Ori.js";import"./vdirs-DRH9Xvnd.js";import"./@juggle/resize-observer-C8OzoCMD.js";import"./css-render-CKtry55Z.js";import"./treemate-HRdUPn5m.js";import"./date-fns-tz-7ws4grit.js";import"./async-validator-9PlIezaS.js";import"./@css-render/plugin-bem-Be8eOoM-.js";const M={class:"min-h-screen flex items-center justify-center p-4"},P={class:"space-y-3"},D={class:"flex items-center gap-2"},T={class:"flex gap-2 justify-end"},ke=$({__name:"Register",setup(G){const y=A(),l=U(),w=B(),N=f(null),t=F({email:"",password:"",confirm:"",code:""}),n=f(!1),u=f(!1),m=f(!1),g=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/,_=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$/,b=/^\d{4,6}$/,R={email:[{required:!0,message:"请输入邮箱",trigger:["input","blur"]},{validator:(i,e)=>g.test(String(e||"")),message:"邮箱格式不正确",trigger:["input","blur"]}],password:[{required:!0,message:"请输入密码",trigger:["input","blur"]},{validator:(i,e)=>_.test(String(e||"")),message:"至少8位且含大小写字母和数字",trigger:["input","blur"]}],confirm:[{required:!0,message:"请确认密码",trigger:["input","blur"]},{validator:(i,e)=>String(e||"")===t.password,message:"两次输入不一致",trigger:["input","blur"]}],code:[{required:!0,message:"请输入验证码",trigger:["input","blur"]},{validator:(i,e)=>b.test(String(e||"")),message:"验证码为4-6位数字",trigger:["input","blur"]}]},C=I(()=>g.test(t.email.trim())&&_.test(t.password.trim())&&t.confirm===t.password&&b.test(t.code.trim()));async function h(){const i=t.email.trim();if(!g.test(i)){l.error("请先填写正确邮箱");return}await L(i)}async function q(){try{if(m.value)return;if(!C.value){l.error("请检查输入项");return}m.value=!0,await S(t.email.trim(),t.password.trim(),t.code.trim()),l.success("注册成功，请登录"),w.requireLogin(),y.push("/")}catch(i){l.error((i==null?void 0:i.message)||"注册失败")}finally{m.value=!1}}function z(){w.requireLogin(),y.push("/")}return(i,e)=>(E(),j("div",M,[r(o(Z),{style:{"max-width":"520px",width:"92vw"},title:"注册"},{default:s(()=>[r(o(V),{ref_key:"formRef",ref:N,model:t,rules:R},{default:s(()=>[v("div",P,[r(o(d),{path:"email"},{default:s(()=>[r(o(p),{value:t.email,"onUpdate:value":e[0]||(e[0]=a=>t.email=a),placeholder:"邮箱"},null,8,["value"])]),_:1}),r(o(d),{path:"password"},{default:s(()=>[r(o(p),{value:t.password,"onUpdate:value":e[2]||(e[2]=a=>t.password=a),type:n.value?"text":"password",maxlength:"16",placeholder:"密码"},{suffix:s(()=>[r(o(k),{icon:n.value?"mdi:eye-off-outline":"mdi:eye-outline",class:"cursor-pointer text-neutral-400",onClick:e[1]||(e[1]=a=>n.value=!n.value)},null,8,["icon"])]),_:1},8,["value","type"])]),_:1}),r(o(d),{path:"confirm"},{default:s(()=>[r(o(p),{value:t.confirm,"onUpdate:value":e[4]||(e[4]=a=>t.confirm=a),type:u.value?"text":"password",maxlength:"16",placeholder:"确认密码"},{suffix:s(()=>[r(o(k),{icon:u.value?"mdi:eye-off-outline":"mdi:eye-outline",class:"cursor-pointer text-neutral-400",onClick:e[3]||(e[3]=a=>u.value=!u.value)},null,8,["icon"])]),_:1},8,["value","type"])]),_:1}),v("div",D,[r(o(d),{class:"flex-1",path:"code"},{default:s(()=>[r(o(p),{value:t.code,"onUpdate:value":e[5]||(e[5]=a=>t.code=a),maxlength:"6",placeholder:"邮箱验证码"},null,8,["value"])]),_:1}),r(o(c),{size:"small",tertiary:"",onClick:h},{default:s(()=>[...e[6]||(e[6]=[x("发送验证码",-1)])]),_:1})]),v("div",T,[r(o(c),{onClick:z},{default:s(()=>[...e[7]||(e[7]=[x("已有账号？去登录",-1)])]),_:1}),r(o(c),{disabled:!C.value,loading:m.value,type:"primary",onClick:q},{default:s(()=>[...e[8]||(e[8]=[x("注册",-1)])]),_:1},8,["disabled","loading"])])])]),_:1},8,["model"])]),_:1})]))}});export{ke as default};
